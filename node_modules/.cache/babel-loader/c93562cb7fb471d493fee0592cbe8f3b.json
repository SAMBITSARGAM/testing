{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/sambi/Downloads/depos-interface-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\sambi\\\\Downloads\\\\depos-interface-master\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";/* eslint-disable */import Web3 from\"web3\";import IPool from\"../contracts/IPool.sol/IPool.json\";import IERC20 from\"../contracts/IPool.sol/IERC20.json\";import{POOL,USDC}from\"../constants/contractAddresses\";var provider;var web3;var message;var pool;var ALLOWANCE=BigInt(Math.pow(10,25));export var initWeb3Account=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(callback){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!window.ethereum){_context.next=12;break;}provider=window.ethereum;_context.prev=2;_context.next=5;return window.ethereum.enable();case 5:_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](2);console.error(\"User denied account access\");case 10:_context.next=13;break;case 12:provider=new Web3.providers.HttpProvider(\"https://godwoken-testnet-v1.ckbapp.dev\");case 13:web3=new Web3(provider);web3.eth.getAccounts(function(err,accs){if(err!=null){console.error(\"无法获取账号， 是否安装了 Metamask\");message=\"\";return;}if(accs.length===0){console.error(\"无法获取账号，Metamask 时候正cd 确配置.\");return;}// this.account = ;\ncallback(web3,accs[0]);ethereum.on(\"accountsChanged\",function(accounts){console.error(\"accountsChanged\");callback(web3,accounts[0]);});});initPoolContract(web3);case 16:case\"end\":return _context.stop();}}},_callee,null,[[2,7]]);}));return function initWeb3Account(_x){return _ref.apply(this,arguments);};}();var initPoolContract=function initPoolContract(web3){pool=new web3.eth.Contract(IPool.abi,POOL);};export var getGammaFactor=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return pool.methods.GetGammaFactor().call();case 2:result=_context2.sent;console.log(result);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function getGammaFactor(){return _ref2.apply(this,arguments);};}();export var timeDeposit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(account,asset,amount,time,handleSuccess,handleError){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return pool.methods.timeDeposit(asset,amount,time).send({from:account}).on(\"receipt\",function(receipt){handleSuccess(receipt);}).on(\"error\",function(error){handleError(error);});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function timeDeposit(_x2,_x3,_x4,_x5,_x6,_x7){return _ref3.apply(this,arguments);};}();export var getAllowance=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(account){var approval;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:approval=new web3.eth.Contract(IERC20.abi,USDC);_context4.next=3;return approval.methods.allowance(account,POOL).call();case 3:return _context4.abrupt(\"return\",_context4.sent);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function getAllowance(_x8){return _ref4.apply(this,arguments);};}();export var approval=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(account){var approval;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:approval=new web3.eth.Contract(IERC20.abi,USDC);_context5.next=3;return approval.methods.approve(POOL,ALLOWANCE).send({from:account}).on(\"receipt\",function(receipt){console.log(receipt);});case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function approval(_x9){return _ref5.apply(this,arguments);};}();export var withdraw=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(account,id,handleSuccess,handleError){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return pool.methods.timeWithdraw(id).send({from:account}).on(\"receipt\",function(receipt){handleSuccess(receipt);}).on(\"error\",function(error){handleError(error);});case 2:case\"end\":return _context6.stop();}}},_callee6);}));return function withdraw(_x10,_x11,_x12,_x13){return _ref6.apply(this,arguments);};}();export var viewDeposits=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(currentAccount){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return pool.methods.getUserTimeDeposit(USDC).call({from:currentAccount});case 2:return _context7.abrupt(\"return\",_context7.sent);case 3:case\"end\":return _context7.stop();}}},_callee7);}));return function viewDeposits(_x14){return _ref7.apply(this,arguments);};}();","map":{"version":3,"names":["Web3","IPool","IERC20","POOL","USDC","provider","web3","message","pool","ALLOWANCE","BigInt","initWeb3Account","callback","window","ethereum","enable","console","error","providers","HttpProvider","eth","getAccounts","err","accs","length","on","accounts","initPoolContract","Contract","abi","getGammaFactor","methods","GetGammaFactor","call","result","log","timeDeposit","account","asset","amount","time","handleSuccess","handleError","send","from","receipt","getAllowance","approval","allowance","approve","withdraw","id","timeWithdraw","viewDeposits","currentAccount","getUserTimeDeposit"],"sources":["C:/Users/sambi/Downloads/depos-interface-master/src/types/proxy.js"],"sourcesContent":["/* eslint-disable */\nimport Web3 from \"web3\";\nimport IPool from \"../contracts/IPool.sol/IPool.json\";\nimport IERC20 from \"../contracts/IPool.sol/IERC20.json\";\nimport { POOL, USDC } from \"../constants/contractAddresses\";\n\nlet provider;\nlet web3;\nlet message;\n\nlet pool;\n\nconst ALLOWANCE = BigInt(10 ** 25);\n\nexport const initWeb3Account = async (callback) => {\n  if (window.ethereum) {\n    provider = window.ethereum;\n    try {\n      await window.ethereum.enable();\n    } catch (error) {\n      console.error(\"User denied account access\");\n    }\n  } else {\n    provider = new Web3.providers.HttpProvider(\n      \"https://godwoken-testnet-v1.ckbapp.dev\"\n    );\n  }\n  web3 = new Web3(provider);\n\n  web3.eth.getAccounts((err, accs) => {\n    if (err != null) {\n      console.error(\"无法获取账号， 是否安装了 Metamask\");\n      message = \"\";\n      return;\n    }\n\n    if (accs.length === 0) {\n      console.error(\"无法获取账号，Metamask 时候正cd 确配置.\");\n      return;\n    }\n    // this.account = ;\n    callback(web3, accs[0]);\n\n    ethereum.on(\"accountsChanged\", (accounts) => {\n      console.error(\"accountsChanged\");\n      callback(web3, accounts[0]);\n    });\n  });\n  initPoolContract(web3);\n};\n\nconst initPoolContract = (web3) => {\n  pool = new web3.eth.Contract(IPool.abi, POOL);\n};\n\nexport const getGammaFactor = async () => {\n  const result = await pool.methods.GetGammaFactor().call();\n  console.log(result);\n};\n\nexport const timeDeposit = async (\n  account,\n  asset,\n  amount,\n  time,\n  handleSuccess,\n  handleError\n) => {\n  await pool.methods\n    .timeDeposit(asset, amount, time)\n    .send({\n      from: account,\n    })\n    .on(\"receipt\", function (receipt) {\n      handleSuccess(receipt);\n    })\n    .on(\"error\", function (error) {\n      handleError(error);\n    });\n};\n\nexport const getAllowance = async (account) => {\n  const approval = new web3.eth.Contract(IERC20.abi, USDC);\n  return await approval.methods.allowance(account, POOL).call();\n};\n\nexport const approval = async (account) => {\n  const approval = new web3.eth.Contract(IERC20.abi, USDC);\n  await approval.methods\n    .approve(POOL, ALLOWANCE)\n    .send({\n      from: account,\n    })\n    .on(\"receipt\", (receipt) => {\n      console.log(receipt);\n    });\n};\n\nexport const withdraw = async (account, id, handleSuccess, handleError) => {\n  await pool.methods\n    .timeWithdraw(id)\n    .send({ from: account })\n    .on(\"receipt\", function (receipt) {\n      handleSuccess(receipt);\n    })\n    .on(\"error\", function (error) {\n      handleError(error);\n    });\n};\n\nexport const viewDeposits = async (currentAccount) => {\n  return await pool.methods\n    .getUserTimeDeposit(USDC)\n    .call({ from: currentAccount });\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}